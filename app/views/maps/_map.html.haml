#map
#map-buttons
  = link_to 'Identify', '#', :id => 'map-identify', :class => 'btn btn-primary', 'data-toggle'=>"button"
#map-messages.row
#map-legends
  .accordion-group
    .accordion-heading
      = link_to 'Map Info', '#map-buttons', :class => 'accordion-toggle', "data-toggle" => "collapse", "data-parent" => "#map-legends"
    #map-buttons.accordion-body.in.collapse
      .accordion-inner
        %h3
          = active_map.title
          Legend      
        - active_map.layers.each do |layer|
          %div.form-inline{id: "layer-legend-#{layer.slug}"}        
            = render 'legend', layer: layer
            = render 'filter', layer: layer
:javascript
  #{yield :styles_javascript}            
  $(document).ready(function() {
    uber = new UberMap();
    uber.init('#{active_map.projection}');    
    #{ load_all_map_layers(active_map) }
  });
  $(document).on('click', '.style-checkbox input', function(e) {
    var name = $(e.target).val();
    var checked = $(e.target).attr('checked');
    var layers = uber.map.getLayersByName(name);
    layers[0].setVisibility(checked);
  });  
  
