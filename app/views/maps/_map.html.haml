#map-container
  #map
  #sidebar.accordion
    .accordion-group
      .accordion-heading.accordion-toggle{ data: { toggle: 'collapse', parent: '#sidebar', target: '#legends'} }
        %h5
          %i.icon-white.icon-chevron-up
          Legend
      #legends.accordion-body.collapse.in
        .accordion-inner
          %ul.legend.nav
            - active_map.layers.each do |layer|
              - cache layer do
                - if layer.children.count > 0
                  - layer.children.each do |child|
                    = render 'legend', layer: child
                    = render 'filter', layer: child
                - else
                  = render 'legend', layer: layer
                  = render 'filter', layer: layer              
    .accordion-group
      .accordion-heading.accordion-toggle{ data: { toggle: 'collapse', parent: '#sidebar', target: '#help'} }
        %h5 
          %i.icon-white.icon-chevron-down
          Help
      #help.accordion-body.collapse
        .accordion-inner
          = render 'help'
#map-messages
#map-tools
  %p
    = link_to '#', :id => 'map-identify', :class => 'btn btn-small btn-primary', 'data-toggle'=>"button" do
      %i.icon-info-sign.icon-white
  
  %p
    .btn.btn-small.btn-success{ data: { toggle: 'collapse', parent: '#sidebar', target: '#help' } }
      %i.icon-question-sign.icon-white
  
:javascript
  #{yield :styles_javascript}    
  (new Map()).init('#{active_map.projection}');
